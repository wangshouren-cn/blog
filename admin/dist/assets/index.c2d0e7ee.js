import{R as D,f as N,r as t}from"./vendor.2fb7d379.js";import{m as j,n as M,j as a,B as o,o as p,I as T,c as r,F as C,p as _,q as w,M as z,r as I,T as f,L as P,s as O,t as R,v as $,w as q,x as H}from"./index.b59ad4d7.js";import i from"./index.module.d09aeace.js";const K=()=>{const l=N(),{dataMap:y,errors:g,loading:B,run:u}=j({article:()=>R($(window.location.search)),tag:q,category:H}),[d,k]=M({page:1,pageSize:20});t.exports.useLayoutEffect(()=>{u()},[]);const c=t.exports.useCallback(e=>{Object.assign(d,e),k(d),u(["article"])},[d]),v=t.exports.useCallback((e,s)=>{c({title:s,page:1})},[]),x=t.exports.useCallback(e=>{c({page:e})},[]),A=t.exports.useCallback(e=>{l("/Article/Look?id="+e)},[]),E=t.exports.useCallback(e=>{c({tags:e.join(",")})},[]),b=t.exports.useCallback(e=>{c({category:e[0]})},[]),F=t.exports.useMemo(()=>[{field:"title",name:"\u6807\u9898"},{field:"content",name:"\u5185\u5BB9",render:(e,s)=>a(o,{onClick:()=>A(s._id),children:"\u67E5\u770B"})},{field:"introduction",name:"\u4ECB\u7ECD"},{field:"tags",name:"\u6807\u7B7E",render:e=>e==null?void 0:e.map(s=>a(p,{value:s},s))},{field:"category",name:"\u5206\u7C7B",render:e=>e&&a(p,{value:e})},{field:"likeNum",name:"\u70B9\u8D5E\u6570"},{field:"collectNum",name:"\u6536\u85CF\u6570"},{field:"cover",name:"\u5C01\u9762",render(e){return e?a(T,{src:e.url}):null}},{name:"\u64CD\u4F5C",render:(e,s)=>r(C,{children:[a(o,{onClick:()=>S(s._id),type:"danger",children:"\u5220\u9664"}),a(o,{onClick:()=>L(s._id),children:"\u7F16\u8F91"})]})}],[]),L=t.exports.useCallback(e=>{l(`/Article/Edit?id=${e}`)},[]),S=t.exports.useCallback(async e=>{_.confirm({content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417?",onOk:async()=>{await w(e),await u()}})},[]);g.length>0&&z.error(g.join("\uFF1B"));const{article:n,category:m,tag:h}=y;return r(C,{children:[r("section",{children:[a("div",{className:i["search-item"],children:a(o,{onClick:()=>l("/article/create"),type:"success",children:"\u521B\u5EFA\u6587\u7AE0"})}),a("div",{className:i["search-item"],children:a(I,{onButtonClick:v,buttonPos:"right",children:"\u641C\u7D22"})}),h&&r("div",{className:i["search-item"],children:["\u6807\u7B7E",a(f,{style:{marginLeft:".5rem"},onActiveChange:E,defaultValue:h.list.map(({name:e})=>e)})]}),m&&r("div",{className:i["search-item"],children:["\u5206\u7C7B",a(f,{style:{marginLeft:".5rem"},single:!0,onActiveChange:b,value:m.list.map(({name:e})=>e)})]})]}),a(P,{loading:B,children:n&&a(O,{onPageChange:x,page:n.page,pageSize:n.pageSize,trKey:"_id",columns:F,records:n.list,total:n.total})})]})};var J=D.memo(K);export{J as default};
