import{R as S,p as N,q as j,s as M,r as t,t as o,v as C,I as T,w as _,x as w,M as z,y as I,T as p,L as P,z as O,A as R,C as $,D as q,E as H}from"./vendor.62f997fd.js";import i from"./index.module.d09aeace.js";import{j as a,a as r,F as f}from"./index.aef5b0f1.js";const K=()=>{const l=N(),{dataMap:y,errors:g,loading:k,run:u}=j({article:()=>R($(window.location.search)),tag:q,category:H}),[d,B]=M({page:1,pageSize:20});t.exports.useLayoutEffect(()=>{u()},[]);const c=t.exports.useCallback(e=>{Object.assign(d,e),B(d),u(["article"])},[d]),v=t.exports.useCallback((e,s)=>{c({title:s,page:1})},[]),x=t.exports.useCallback(e=>{c({page:e})},[]),A=t.exports.useCallback(e=>{l("/Article/Look?id="+e)},[]),E=t.exports.useCallback(e=>{c({tags:e.join(",")})},[]),b=t.exports.useCallback(e=>{c({category:e[0]})},[]),F=t.exports.useMemo(()=>[{field:"title",name:"\u6807\u9898"},{field:"content",name:"\u5185\u5BB9",render:(e,s)=>a(o,{onClick:()=>A(s._id),children:"\u67E5\u770B"})},{field:"introduction",name:"\u4ECB\u7ECD"},{field:"tags",name:"\u6807\u7B7E",render:e=>e==null?void 0:e.map(s=>a(C,{value:s},s))},{field:"category",name:"\u5206\u7C7B",render:e=>e&&a(C,{value:e})},{field:"likeNum",name:"\u70B9\u8D5E\u6570"},{field:"collectNum",name:"\u6536\u85CF\u6570"},{field:"cover",name:"\u5C01\u9762",render(e){return e?a(T,{src:e.url}):null}},{name:"\u64CD\u4F5C",render:(e,s)=>r(f,{children:[a(o,{onClick:()=>D(s._id),type:"danger",children:"\u5220\u9664"}),a(o,{onClick:()=>L(s._id),children:"\u7F16\u8F91"})]})}],[]),L=t.exports.useCallback(e=>{l(`/Article/Edit?id=${e}`)},[]),D=t.exports.useCallback(async e=>{_.confirm({content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417?",onOk:async()=>{await w(e),await u()}})},[]);g.length>0&&z.error(g.join("\uFF1B"));const{article:n,category:m,tag:h}=y;return r(f,{children:[r("section",{children:[a("div",{className:i["search-item"],children:a(o,{onClick:()=>l("/article/create"),type:"success",children:"\u521B\u5EFA\u6587\u7AE0"})}),a("div",{className:i["search-item"],children:a(I,{onButtonClick:v,buttonPos:"right",children:"\u641C\u7D22"})}),h&&r("div",{className:i["search-item"],children:["\u6807\u7B7E",a(p,{style:{marginLeft:".5rem"},onActiveChange:E,defaultValue:h.list.map(({name:e})=>e)})]}),m&&r("div",{className:i["search-item"],children:["\u5206\u7C7B",a(p,{style:{marginLeft:".5rem"},single:!0,onActiveChange:b,value:m.list.map(({name:e})=>e)})]})]}),a(P,{loading:k,children:n&&a(O,{onPageChange:x,page:n.page,pageSize:n.pageSize,trKey:"_id",columns:F,records:n.list,total:n.total})})]})};var J=S.memo(K);export{J as default};
