(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1656:function(e,t,i){"use strict";var r=i(29),n=i(7794),c=i.n(n),a=i(7294),s=i(3964),l=i(5954),o=i(6993),_=i(1739),u=i.n(_),d=i(4184),m=i.n(d),f=i(6741),p=i(5893);t.Z=function(e){var t,i=e.article,n=(i.title,i.tags),_=(i.content,i.category),d=i.createTime,x=i.likeNum,g=(i.cover,i.comments,i._id),h=(0,s.NW)(),A=(0,l.Z)(),v=A.user,N=A.setUser,y=null===v||void 0===v||null===(t=v.articleIds)||void 0===t?void 0:t.includes(g),j=(0,a.useCallback)((0,r.Z)(c().mark((function e(){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",s.v0.error("\u52a8\u52a8\u624b\u6307\u767b\u5f55\u4e0b\u5427~"));case 2:if(t=v.articleIds,-1!==(r=t.indexOf(g))){e.next=12;break}return t.push(g),e.next=8,(0,f.Nq)(v._id,{articleIds:t});case 8:i.likeNum++,s.v0.success("\u6536\u85cf\u6210\u529f"),e.next=17;break;case 12:return t.splice(r,1),e.next=15,(0,f.Nq)(v._id,{articleIds:t});case 15:i.likeNum--,s.v0.success("\u5df2\u53d6\u6d88\u6536\u85cf");case 17:h(),N(v);case 19:case"end":return e.stop()}}),e)}))),[v,g]);return(0,p.jsxs)("ul",{className:u().detail,children:[(0,p.jsxs)("li",{className:u().categoryBox,children:[(0,p.jsx)(o.Z,{type:"icon-category"})," ",(0,p.jsx)("span",{className:u().category,children:_})]}),(0,p.jsxs)("li",{className:u().tagBox,children:[(0,p.jsx)(o.Z,{type:"icon-tags"}),n&&n.length>0&&n.map((function(e){return(0,p.jsx)("span",{className:u().tag,children:e},e)}))]}),(0,p.jsxs)("li",{className:u().dateBox,children:[(0,p.jsx)(o.Z,{type:"icon-ico-date"}),(0,p.jsx)("span",{className:u().date,children:(0,s.m8)(d)})]}),(0,p.jsxs)("li",{children:[(0,p.jsx)(o.Z,{onClick:j,className:m()(u().like,{"color-red":y}),type:"icon-like"}),(0,p.jsx)("span",{className:u().likeNum,children:x})]})]})}},7493:function(e,t,i){"use strict";i.d(t,{Z:function(){return N}});var r=i(29),n=i(7794),c=i.n(n),a=i(7294),s=i(3964),l=i(4078),o=i.n(l),_=i(4184),u=i.n(_),d=i(1656),m=i(7175),f=i.n(m),p=i(5893),x=function(e){return(0,p.jsx)("div",{className:f().empty,children:"\u65e0\u5185\u5bb9"})},g=i(1163),h=i(5694),A=i(98);function v(e){return e.replace(/\<.+?\>/g,"")}var N=function(e){var t=e.api,i=(0,A.Z)(t),n=i.run,l=i.list,_=i.loading,m=i.page,f=i.total,N=i.pageSize,y=i.setSearchAndRun,j=(0,a.useState)(!0),k=(j[0],j[1]),D=(0,g.useRouter)(),w=(0,a.useCallback)((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)}))),[n]);(0,a.useEffect)((function(){w()}),[(0,s.X6)(D.query),w]),(0,a.useEffect)((function(){_||window.scrollTo({top:Number(sessionStorage.getItem("scrollTop")||0)})}),[_]);var b=(0,a.useCallback)((function(e){sessionStorage.setItem("scrollTop",window.pageYOffset.toString()),D.push("/article?id=".concat(e))}),[D]),B=(0,a.useRef)();return(0,a.useEffect)((function(){var e=null;if(B.current)return e=setTimeout((function(){new IntersectionObserver((function(e){e.forEach((function(e){var t=m<Math.ceil(f/N);e.isIntersecting&&t&&(k(!1),sessionStorage.setItem("scrollTop",window.pageYOffset.toString()),y({pageSize:N+20}))}))})).observe(B.current)}),2e3),function(){clearTimeout(e)}}),[B.current,m,N,f]),(0,p.jsx)(h.Z,{loading:_,children:(0,p.jsx)("ul",{className:o().ul,children:l.length>0?(0,p.jsxs)(p.Fragment,{children:[l.map((function(e){var t=e._id,i=e.title,r=e.content,n=e.cover;e.category,e.tags,e.createTime;return(0,p.jsxs)("li",{className:o().li,children:[(0,p.jsxs)("div",{className:o().content,children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{onClick:function(){return b(t)},className:o().title,children:i}),(0,p.jsx)("span",{children:r.length>200?v(r.substring(0,50))+"[...]":v(r)})]}),n&&n.url?(0,p.jsx)(s.Ei,{className:u()(o().img),src:n.url}):null]}),(0,p.jsx)(d.Z,{article:e})]},t)})),m<Math.ceil(f/N)&&(0,p.jsx)("div",{className:o().loadMore,ref:B,children:"..."})]}):(0,p.jsx)(x,{})})})}},5006:function(e,t,i){"use strict";i.r(t);var r=i(3964),n=i(7493),c=i(4848),a=i.n(c),s=i(5893);t.default=function(){return(0,s.jsx)("div",{className:a().container,children:(0,s.jsx)(n.Z,{api:r.DA})})}},5301:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(5006)}])},1739:function(e){e.exports={categoryBox:"ArticleDetail_categoryBox__hUFBN",tagBox:"ArticleDetail_tagBox__f_bWj",detail:"ArticleDetail_detail__WAXvj",dateBox:"ArticleDetail_dateBox__ay2Es",container:"ArticleDetail_container__nas4z",articleContainer:"ArticleDetail_articleContainer__sBEDL",title:"ArticleDetail_title__mhedz",cover:"ArticleDetail_cover__GACPc",tag:"ArticleDetail_tag__0_BSF",category:"ArticleDetail_category__X2XYA",likeNum:"ArticleDetail_likeNum__UsOBM",date:"ArticleDetail_date__ykFJg",commentContainer:"ArticleDetail_commentContainer__3l1rF",commentTitle:"ArticleDetail_commentTitle__vYePf",replyContainer:"ArticleDetail_replyContainer__l7Ymo",empty:"ArticleDetail_empty__wA9Nr",like:"ArticleDetail_like__9_pD2"}},4078:function(e){e.exports={ul:"ArticleList_ul__8wGx_",li:"ArticleList_li__9yDY9",title:"ArticleList_title__uyQII",content:"ArticleList_content__k_zqp",img:"ArticleList_img__iYiPd",footer:"ArticleList_footer__3NaRg",category:"ArticleList_category__d4cyL",tag:"ArticleList_tag__MaMfE",createTime:"ArticleList_createTime__2yemA",empty:"ArticleList_empty__4QMkB",pageOperations:"ArticleList_pageOperations__yg59q",loadMore:"ArticleList_loadMore__fnhvr"}},7175:function(e){e.exports={empty:"Empty_empty__jAuf1"}},4848:function(e){e.exports={container:"index_container__Xi8tY"}}},function(e){e.O(0,[774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);